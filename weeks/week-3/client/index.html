<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Course & Professor Manager</title>

<script>
const COURSE_API = "/api/courses";
const PROFESSOR_API = "/api/professors";

/* =========================
   NAVIGATION
========================= */
function showCreateCourse() {
  document.getElementById("createCourseScreen").style.display = "block";
  document.getElementById("coursesScreen").style.display = "none";
  document.getElementById("professorsScreen").style.display = "none";
}

function showCourses() {
  document.getElementById("createCourseScreen").style.display = "none";
  document.getElementById("coursesScreen").style.display = "block";
  document.getElementById("professorsScreen").style.display = "none";
  loadCourses();
}

function showProfessors() {
  document.getElementById("createCourseScreen").style.display = "none";
  document.getElementById("coursesScreen").style.display = "none";
  document.getElementById("professorsScreen").style.display = "block";
  loadProfessors();
}

/* =========================
   COURSES
========================= */
function loadCourses() {
  fetch(COURSE_API)
    .then(res => res.json())
    .then(courses => {
      const resultDiv = document.getElementById("courseResult");
      resultDiv.innerHTML = "";
      courses.forEach(course => {
        resultDiv.innerHTML += `
          <div>
            <b>${course.name}</b> - ${course.credits} credits
            <button onclick="editCourse('${course._id}','${course.name}',${course.credits})">Edit</button>
            <button onclick="deleteCourse('${course._id}')">Delete</button>
          </div><br>
        `;
      });
    });
}

function createCourse() {
  const name = document.getElementById("name").value;
  const credits = document.getElementById("credits").value;
  if (!name || !credits) {
    alert("Please fill all fields");
    return;
  }
  fetch(COURSE_API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, credits: Number(credits) })
  })
  .then(res => res.json())
  .then(() => {
    document.getElementById("name").value = "";
    document.getElementById("credits").value = "";
    alert("Course created successfully!");
    loadCourses();
  });
}

function deleteCourse(id) {
  fetch(`${COURSE_API}/${id}`, { method: "DELETE" })
    .then(() => loadCourses());
}

function editCourse(id, name, credits) {
  const newName = prompt("New course name:", name);
  const newCredits = prompt("New credits:", credits);
  if (!newName || !newCredits) return;
  fetch(`${COURSE_API}/${id}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name: newName, credits: Number(newCredits) })
  })
  .then(() => loadCourses());
}

/* =========================
   PROFESSORS
========================= */
function loadProfessors() {
  fetch(PROFESSOR_API)
    .then(res => res.json())
    .then(professors => {
      const resultDiv = document.getElementById("professorResult");
      resultDiv.innerHTML = "";
      professors.forEach(p => {
        resultDiv.innerHTML += `
          <div>
            <b>${p.nombre} ${p.apellidos}</b> - ${p.edad} a√±os
            <button onclick="editProfessor('${p._id}','${p.nombre}','${p.apellidos}',${p.edad})">Edit</button>
            <button onclick="deleteProfessor('${p._id}')">Delete</button>
          </div><br>
        `;
      });
    });
}

function createProfessor() {
  const nombre = document.getElementById("profNombre").value;
  const apellidos = document.getElementById("profApellidos").value;
  const edad = document.getElementById("profEdad").value;
  if (!nombre || !apellidos || !edad) {
    alert("Please fill all fields");
    return;
  }
  fetch(PROFESSOR_API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nombre, apellidos, edad: Number(edad) })
  })
  .then(res => res.json())
  .then(() => {
    document.getElementById("profNombre").value = "";
    document.getElementById("profApellidos").value = "";
    document.getElementById("profEdad").value = "";
    alert("Professor created successfully!");
    loadProfessors();
  });
}

function deleteProfessor(id) {
  fetch(`${PROFESSOR_API}/${id}`, { method: "DELETE" })
    .then(() => loadProfessors());
}

function editProfessor(id, nombre, apellidos, edad) {
  const newNombre = prompt("New name:", nombre);
  const newApellidos = prompt("New surname:", apellidos);
  const newEdad = prompt("New age:", edad);
  if (!newNombre || !newApellidos || !newEdad) return;
  fetch(`${PROFESSOR_API}/${id}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nombre: newNombre, apellidos: newApellidos, edad: Number(newEdad) })
  })
  .then(() => loadProfessors());
}
</script>
</head>

<body>
<!-- =========================
     CREATE COURSE SCREEN
========================= -->
<div id="createCourseScreen">
  <h2>Create Course</h2>
  <input type="text" id="name" placeholder="Course Name">
  <input type="number" id="credits" placeholder="Credits">
  <button onclick="createCourse()">Create</button>
  <br><br>
  <button onclick="showCourses()">View Courses</button>
  <button onclick="showProfessors()">View Professors</button>
</div>

<!-- =========================
     COURSES SCREEN
========================= -->
<div id="coursesScreen" style="display:none;">
  <h2>All Courses</h2>
  <button onclick="showCreateCourse()">Back</button>
  <button onclick="loadCourses()">Reload</button>
  <br><br>
  <div id="courseResult"></div>
</div>

<!-- =========================
     PROFESSORS SCREEN
========================= -->
<div id="professorsScreen" style="display:none;">
  <h2>All Professors</h2>
  <input type="text" id="profNombre" placeholder="Name">
  <input type="text" id="profApellidos" placeholder="Surname">
  <input type="number" id="profEdad" placeholder="Age">
  <button onclick="createProfessor()">Create Professor</button>
  <br><br>
  <button onclick="showCreateCourse()">Back</button>
  <button onclick="loadProfessors()">Reload</button>
  <br><br>
  <div id="professorResult"></div>
</div>
</body>
</html>
